#!/usr/bin/awk -f

function range(start, end) {
    if (start > end) return ""
    out=$start
    for (i = start+1; i <= end; i++) out=out" "$i
    return out
}

BEGIN {
    red="\033[31m"
    green="\033[32m"
    yellow="\033[33m"
    magenta="\033[35m"
    blue="\033[34m"
    cyan="\033[36m"
    black="\033[30m"
    grey="\033[90m"
    reset="\033[0m"
}

{ printf " " }

/^## / { print $0; next; }
/^ *M +/ { printf yellow; }
/^ *A +/ { printf green; }
/^ *D +/ { printf red; }
/^ *R +/ { printf magenta; }
/^\?\? / { printf grey; }
!/(^## )|(^ *M +)|(^ *A +)|(^ *D +)|(^ *R +)|(^\?\? )/ { printf black; }

/^ .+/ { $1=" "$1; }
/^. .*/ { $1=$1" "; }
{ print range(1, 2) reset range(3, NF); }
